---
title: "Analysing Data of Invest Survey"
author: "Marie HÃ¸jlund Christiansen and Mia Thuge Kuntz"
date: "`r Sys.Date()`"
output: html_document
---

# Getting started
## Introduction to the project
The motivation and background for this project can be found in our report. Based on this, along with our expectations originated from the bachground part of the report, we know wish to conduct an analytically and visually focused project, which hopefully will shed light on some correlations and dependencies between the variables. It is important to note, that the following test and the chosen variables and their relationships are chosen based on our own assumptions to their outcome, where we wish to investigate the actual result and whether or not it fits our expectations.

## Data set and variables
The following project make use of the *invest_survey* data set, with the following variables and their explanations. These are based on the survey questions the data set is based on, which can be found in APPENDIX 1:

- Gender of respondent
  + man
- Age of respondent
  + Age
- Relationship status of respondent
  + Partner
- Educational level of respondent on a scale of 1-5 
  + edu
- Economical or mathematical focus in respondent's education on a scale of 1-5
  + edu_econ
- Perceived financial literacy on a scale of 1-5
  + per_fl
- Actual financial literacy on a scale of 1-3 
  + fl_grade 
- Whether the respondent has invested or not
  + invest
- The category/type of investment
  + invest_c
- Different types of questions pertaining to the respondent's attitude toward finances and economic concepts are shown through following variables
  + stat_1
  + stat_2
  + stat_3
  + stat_4
  + stat_5
- Perceived risk willingness on a scale of 1-5
  + rw
- Actual risk willingness on a scale of 1-3
  + rw_grade
  
Important to note about several of the variables is that many are binary, where 0 repsresents a "no" and 1 represents a "yes" to the variable name.

The project will make use of the **tidyverse** and **ggpubr** packages along with other libraries when relevant.

## Our tools
In major parts of the project we will make use of correlation tests to see whether it can be proven, by use of the data set based on an investment survey, that there are significant relationships and correlations between our variables. We will use the `cor.test` function to obtain the desired results. Throughout the report, we will include visualisations of different variables used in our tests to shed light on some of their distributions.

# Processing and assessing
The first part of our project is to assess our data by various processing tools and functions. This is done primarily for our own sake, as it provides us with a way of getting familiar with the data - which is always desired when working on a project. The following will be shown in our report, as it is a deliberate choice on our side to show even those functions many would consider to hide in their project by e.g. using the `include = FALSE` function. 

Getting started on the project demands for us to know the directory we are working in, since loading in our data set will be made easier by having set the correct path. We first check is the path is already correct by using the `getwd` function.
```{r wd}
getwd()
```
Luckily we are on the right path, and our working directory is set as the "final_project" folder.

We are now able to correctly load in our data set along with installing some of the necessary packages. We choose to assign the data set to its own object immediately for the further use of it throughout the project
```{r setup}
library(tidyverse)
library(here)
library("ggpubr")

survey <- read.csv2("data/invest_survey.csv")
```

This loads in our data set as a data frame, which we are also able to double check by running the `class` function on the object.
```{r class}
class(survey)
```
This function confirms the data set as a data frame.

We have now successfully imported our data set. To see the different columns - the variables of our data - we use the `names` function.
```{r column names}
names(survey)
```
This provides us with a quick overview of the 16 different variables in the data. 

To further assess the data - perhaps to shows the different observations or data types of the columns - we can either run the object name as a function of its own.
```{r survey}
survey
```
Or use the `str` function.
```{r}
str(survey)
```
As can be seen from the two outputs, it definitely looks cleaner when using the object name to assess the data frame, although both functions were able to give us an overview of the data showing the 16 variables and their column names, along with the 262 observations as row values.

As can be seen from the *invest_c* column, the data contains NA's. To fix this we replace the NA's with 0's using the `is.na` function, and immediatly check it by once again running the object name.
```{r remove NA}
survey[is.na(survey)] = 0
survey
```
The function worked replacing NA's in the data set.

The data types of the different variables show as integer classes (or numeric). This makes sense, as all the observational values are whole numbers
As can be seen from the `str` function, the age variable seems to be sorted from lowest to high. To show the last values of the data frame, and therefor the highest participating ages in the survey, we use the `tail` function.
```{r survey tail}
tail(survey)
```

Here are the last 6 rows of the data frame. If we wanted to e.g. only show the last 10 values of the age variable, we could make use of the `$` function to determine which column we are interested in showing, along with a bit of specification on the `tail` function by setting n=10
```{r age tail}
tail(survey$age, n=10)
```
This shows that the highest participating age is 83. 

To have the rest of our project run along more smoothly and further prepare for the following test and visualisations, we assign each column to its own object.
```{r objects}
man <- (survey$man)
age <- (survey$age)
partner <- (survey$partner)
edu <- (survey$edu)
edu_econ <- (survey$edu_econ)
per_fl <- (survey$per_fl)
fl_grade <- (survey$fl_grade)
invest <- (survey$invest)
invest_c <- (survey$invest_c)
stat_1 <- (survey$stat_1)
stat_2 <- (survey$stat_2)
stat_3 <- (survey$stat_3)
stat_4 <- (survey$stat_4)
stat_5 <- (survey$stat_5)
rw <- (survey$rw)
rw_grade <- (survey$rw_grade)
```

We have now prepared our global environment for further use in our project. The following parts will focus on the different aspects of our problem statement and background for the subject.

# Man and invest
In order to prove our hypothesis stating the difference between men and women when pertaining to their investment participation, we first wish to investigate the relationship between *man* and *invest* - the two variables we find best describes and catches the area we wish to investigate. 

## Distribution
Firstly, by using the **ggplot2**, **ggmosaic** and **devtools** libraries and packages, along with the devtool "haleyjeppson/ggmosaic", we wish to show the immediate distribution in respondents answers to the questions from which the variables were created. We use the `mosaicplot` function to create this visual, where the reason for using this particular plot comes from the fact that we are working with two binary variables.
MAYBE CORRECT ABOVE PACKAGES


```{r man invest plot}
mosaicplot(~man + invest,data=survey, main = "Distrubtuion of gender and invest", xlab = "Gender", ylab = "Investment participation", shade = TRUE)
```

From the immediate distribution it looks as if the men are outnumbered by the women in this study, with the men having answered yes to whether or not they have invested more often than the women. We are able to confirm this by using the `table` function to check the actual distributions of both the *man* and *invest* variables.
```{r}
table(invest, man)
```
We are also able to see from both the mosaic plot and the table, that the biggest difference is actually between the men and women who haven't invested, where 68 female and 33 male respondents answered no to having any type of investments. By adding `shade=TRUE` to our function for the mosaic plot we are able to observe, that the number males who haven't invested, at least in this particular survey, are lower than what the statistic model predicted. 

From this we want to further investigate whether or not this difference between genders and investment participation actually is significant, or if the differences shown aren't as big as we interpret them to be.

## Correlation test
By assessing the p value in the relationship between *man* and *invest* and looking at their correlation effect, we will be able to take a deeper look into the possible significant different. From this we will be able to confirm whether or not being a man has significant influence on the individuals participation in the stock market - That is whether they have invested or not. 
```{r man invest cor}
cor.test(man, invest, method=c("pearson"), alpha=.05)
```
The correlation between the variables = 0,22 indicates that the expected interaction between these variables is low, since gender, in theory, shouldn't predict whether an individual has invested or not. But as we can see from the p value = 0,0003211, which is less than the chosen significance level = 0,05, we conclude, that there is significant dependency between *invest* and *man*. Being a man can therefor be a predictor for whether or not an individual has invested, with men having answered "yes" to having invested more than women. These results follow and realize the expectation we had after looking at the distribution of the variables.

### Visualising the analytics
Following scatter plot is a visualisation of the above results. As we are using two binary variables, the scatter plot won't show much except the co variation between them in the way of our regression line. In addition the scatter plot gives the statistic results we just used the `cor.test` function to get - the p value and correlation. In the plot, where we make use of the `ggscatter` function, we define the variables we wish to create the plot around - these still being *man* and *invest*, along with adding the desired regression line with the confidence intervals, correlation and its chosen p value, and lastly the desired labels and title.
```{r man invest scatter}
ggscatter(survey, x = "man", y = "invest",
          add = "reg.line", conf.int = TRUE,
          cor.coef = TRUE, cor.method = "pearson",
          xlab = "Gender", ylab = "Investment participation", title = "Scatter plot of invest and man")
```

The above plot supports the conclusion of there being dependency between the variables, as a positive R = 0,22 shows that the chances of having invested increases if you are a man, which is visualised by the plot having a slight rise towards the 1 value on the x-axis - the value for being a man in the gender variable.

# Gender and financial literacy
Since we have proven the dependency between gender and invest we now wish to further investigate what else gender may have an influence on, since the aim of this project is to identify where we may see differences in gender behavior- and maybe where gender inequality for women appear. As earlier presented, it is a common goal for women across the world to gain equal access to financial and economic education and counsel. From the provided data set, we will be able to further investigate whether the danish population has obtained equality concerning financial knowledge between both genders.
The data set we use has provided us with two variables for financial literacy - *per_fl*, which is based on the respondents perceived financial literacy, and *fl_grade*, which is based on the respondents score on different questions pertaining to their financial knowledge ranked on a scale from 1-3.

## Distribution
We find it interesting to first take a look at the distributions of the respondents answers to both their perceived and their actual, tested financial literacy. A plot showing the immediate distribution will often give a first glance at what ends up as being the final result, and we therefore include this in our project to gather a quick impression of the results we expect from testing them. We here use bar plots to illustrate, and the choice of facet wrapping by gender was deliberate, as this provide a clean setup still possible to compare.
```{r perceived financial literacy plot}
ggplot(survey) +
  aes(x = per_fl) +
  geom_bar(aes(color = as.factor(man)), position = "dodge") +
  scale_color_manual(values = c("0" = "red",
                                "1" = "blue")) +
  labs(title = "Distribution of man and per_fl", 
      x = "Perceived financial literacy",
      y = "Count") +
  facet_wrap(~ man)
```

```{r actual financial literacy plot}
ggplot(survey) +
  aes(x = fl_grade) +
  geom_bar(aes(color = as.factor(man)), position = "dodge") +
  scale_color_manual(values = c("0" = "red",
                                "1" = "blue")) +
  labs(title = "Distribution of man and per_fl", 
      x = "Actual financial literacy",
      y = "Count") +
  facet_wrap(~ man)
```

Even though the scales on which the two variables are measured aren't the same, we are still able to gather an immediate impression of the distribution between the two genders. Important to remember is that the survey consists of more respondents of the female gender, and so when evaluating these results we have this is mind. 
From the first graphs which illustrates the distribution of the respondents perceived financial literacy we are able to see, that men tends to rate themselves higher than women. From the second graphs which depicts the respondents score on their actual financial literacy we are able to conclude, that the men also seem to score higher when tested than the women. 
MISSING THE LINK TO THE TEXT, FINISH THIS WHEN TEXT IS READY

Apart from the immediate distribution we would also here like to carry out a correlation test for these variables and their possible dependency with gender, since we know that distribution isn't always a reliable measure for significance. 

## Correlation test
We once again use the `cor.test` function to test the two variables for financial literacy to investigate, whether or not any, one or both of them can be seen as statistically significant when testing with gender. First, the perceived financial literacy by using the *per_fl* variable.
```{r man per_fl cor}
cor.test(man, per_fl, method=c("pearson"), alpha=.05)
```
As can be seen from a near 0 p value, the dependency between the perceived financial literacy of the respondents and whether they are a man or woman is significant. That means that based on this study, the men participating were significantly more likely to rate themselves higher on the scale of 1-5 than the female participants. Now we test the actual financial literacy by using the *fl_grade* variable.  
```{r man fl_grade cor}
cor.test(man, fl_grade, method=c("pearson"), alpha=.05)
```
With a p value = 0,0125, which is below the chosen level of significance = 0,05, we see a significant dependency between oneÂ´s gender and actual knowledge on financial matters. In the same matter as the perceived financial literacy, being a man in this particular study means, that you are statistically more likely to score higher on the 1-3 grading than the female participants. Both tests showed a positive correlation with the gender variable, with the test including perceived financial literacy having the highest = 0,25 and actual having the lowest = 0,15. Both of these results support the conclusion of the p value.
It is thought provoking to have seen the differences between genders and their financial knowledge both in the way of distribution as well as having tested the significance. 
- er det bare fordi man er fÃ¸dt man
- er der mere i det end bare kÃ¸n?
  - samfundsnormer
  - muligheder

MISSING THE LINK TO THE TEXT, FINISH THIS WHEN TEXT IS READY



# Gender and risk willingness
As the last part of this project we wish to investigate the relationship between gender and their risk willingness. Our reasoning for including this exploration lies in the way of this being seen as a supplement to the above tests, as the investigation of these variables can be an expression of our own, an perhaps society's, expected outcome in the way of women being less willing to take risk and therefor having invested less than men. Whether or not that is the actual case will be know after we conduct our tests. In this particular data set risk willingness is expressed in two variables much like those for financial literacy - a perceived score on a scale of 1-5 and an actual score on a scale of 1-3. 
INKLUDER MERE BAGGRUND FOR HVORFOR DET ER RELEVANT



## Distribution
First, we take a look on the distributions of the variables in relation to the two genders and their answers. We have used this approach before when looking at the distribution of the variables for financial literacy, and we were here able to conclude, that the initial impression of the distributions were a fair way of gaining a quick insight into the actual outcome of the testing of significance. It is therefore interesting to see, whether this is mere coincidence or if the same applies to the variables for risk willingness. We choose to make use of the same plots as for financial literacy, as the variables representing risk willingness are build up in the same fashion.
```{r perceived risk willingness plot}
ggplot(survey) +
  aes(x = rw) +
  geom_bar(aes(color = as.factor(man)), position = "dodge") +
  scale_color_manual(values = c("0" = "red",
                                "1" = "blue")) +
  labs(title = "Distribution of man and rw", 
      x = "Perceived risk willingness",
      y = "Count") +
  facet_wrap(~ man)
```


```{r actual risk willingness plot}
ggplot(survey) +
  aes(x = rw_grade) +
  geom_bar(aes(color = as.factor(man)), position = "dodge") +
  scale_color_manual(values = c("0" = "red",
                                "1" = "blue")) +
  labs(title = "Distribution of man and rw_grade", 
      x = "Actual risk willingness",
      y = "Count") +
  facet_wrap(~ man)
```

First glance at both of the graphs shows us, that men are far more risk willing by their own assessment as well as their actual risk willingness grade based on their answers to the related questions in the questionnaire. The odd one out is seen in the actual risk willingness for men, where almost none scored a 1. Is could from this alone be concluded, that men based on the study are far more risk willing than women. 
What is also interesting when looking at the perceived risk willingness, as well as the perceived financial literacy, is that the respondents tend to stick close to the middle answers when comparing to how they actually fare and behave. Is gives reason to wonder, if this is a result of the actual behavior in Danes, or if the case study design from which the used data set originates contains certain flaws in its population representation. 

MISSING THE LINK TO THE TEXT, FINISH THIS WHEN TEXT IS READY

## Correlation test
To see whether or not these impressions of the relationship between the two variables for risk willingness and gender are significant, we here carry out a correlation test in the same manner as previously. 
Firstly we test gender and the perceived risk willingness *rw*.
```{r man rw cor}
cor.test(man, rw, method=c("pearson"), alpha=.05)
```

We thereafter test gender and the actual risk willingness *rw_grade*.
```{r man rw_grade cor}
cor.test(man, rw_grade, method=c("pearson"), alpha=.05)
```
Both relationships shows significant dependency and high correlations, with the variable showing the respondents actual risk willingness as the one with the highest correlation with gender = 0,41. From these results we conclude, that being a man does influence both ones perceived and actual risk willingness, with men being a lot more willing to take risks than women - at least in this economically focused study. 
Since men in general scored themselves higher and received actual higher scores we ponder the question, if maybe ones self confidence regarding both knowledge and risk willingness has a higher influence on the actual outcome than first expected. And could this maybe be an indication of a low self confidence in women when pertaining to these factors. 

MISSING THE LINK TO THE TEXT, FINISH THIS WHEN TEXT IS READY

